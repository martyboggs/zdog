/*!
*  musquito v1.0.0 
*  http://musquitojs.com
*
*  (c) 2018 Vijaya Anand
*  http://prideparrot.com
*
*  MIT License
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.$buzz=t():e.$buzz=t()}(window,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._navigator=null,this._contextType=null,this._formats={},"undefined"!=typeof navigator&&(this._navigator=navigator),"undefined"!=typeof AudioContext?this._contextType=AudioContext:"undefined"!=typeof webkitAudioContext&&(this._contextType=webkitAudioContext);var t=new Audio;this._formats={mp3:Boolean(t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:Boolean(t.canPlayType("audio/mpeg;").replace(/^no$/,"")),opus:Boolean(t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")),ogg:Boolean(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")),oga:Boolean(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")),wav:Boolean(t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")),aac:Boolean(t.canPlayType("audio/aac;").replace(/^no$/,"")),caf:Boolean(t.canPlayType("audio/x-caf;").replace(/^no$/,"")),m4a:Boolean((t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,"")),mp4:Boolean((t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,"")),weba:Boolean(t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:Boolean(t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:Boolean(t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,"")),flac:Boolean((t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,""))},t=null}return i(e,[{key:"id",value:function(){return Math.round(Date.now()*Math.random())}},{key:"getContextType",value:function(){return this._contextType}},{key:"getContext",value:function(){return new this._contextType}},{key:"supportedFormats",value:function(){return this._formats}},{key:"isFormatSupported",value:function(e){return Boolean(this._formats[e])}},{key:"getSupportedFormat",value:function(e){var t=this;return e.find(function(e){return t.isFormatSupported(e)})}},{key:"isSourceSupported",value:function(e){var t=this.isBase64(e)?/^data:audio\/([^;,]+);/i.exec(e):/^.+\.([^.]+)$/.exec(e);return!!(t=/^.+\.([^.]+)$/.exec(e))&&this.isFormatSupported(t[1].toLowerCase())}},{key:"getSupportedSource",value:function(e){var t=this;return e.find(function(e){return t.isSourceSupported(e)})}},{key:"isBase64",value:function(e){return/^data:[^;]+;base64,/.test(e)}},{key:"_isMobile",value:function(){return!!this._navigator&&/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(this._navigator.userAgent)}},{key:"_isTouch",value:function(){return"undefined"!=typeof window&&Boolean("ontouchend"in window||this._navigator&&this._navigator.maxTouchPoints>0||this._navigator&&this._navigator.msMaxTouchPoints>0)}}]),e}();t.default=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorType=t.EngineEvents=t.EngineState=t.default=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=d(n(2)),r=d(n(3)),s=d(n(6)),u=d(n(4)),a=d(n(0)),l=d(n(7));function d(e){return e&&e.__esModule?e:{default:e}}var h={NoAudio:"no-audio",LoadError:"load",PlayError:"play",EngineError:"engine"},f={NotReady:"notready",Ready:"ready",Suspending:"suspending",Suspended:"suspended",Resuming:"resuming",Destroying:"destroying",Done:"done",NoAudio:"no-audio"},c={Add:"add",Remove:"remove",Volume:"volume",Mute:"mute",Pause:"pause",Stop:"stop",Suspend:"suspend",Resume:"resume",Error:"error",Done:"done"},_=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","pointerup","touchend","keydown","keyup"],p=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=a.default.id(),this._muted=!1,this._volume=1,this._cleanUpInterval=5,this._autoEnable=!0,this._intervalId=null,this._isAudioAvailable=!1,this._state=f.NotReady,this._context=null,this._gainNode=null,this._queue=null,this._heap=null,this._loader=null,this._heap=new s.default,this._queue=new u.default,this._resumeAndRemoveListeners=this._resumeAndRemoveListeners.bind(this)}return i(e,[{key:"setup",value:function(e){var t=this;if(this._state!==f.NotReady)return this;if(this._context=a.default.getContext(),this._isAudioAvailable=Boolean(this._context),!this._isAudioAvailable)return this._state=f.NoAudio,this._fire(c.Error,{type:h.NoAudio,error:"Web Audio API is not available"}),this;var n=e||{},i=n.volume,r=n.muted,s=n.cleanUpInterval,u=n.autoEnable,l=n.onadd,d=n.onremove,p=n.onstop,y=n.onpause,v=n.onmute,m=n.onvolume,b=n.onsuspend,g=n.onresume,k=n.onerror,S=n.ondone;return"number"==typeof i&&i>=0&&i<=1&&(this._volume=i),"boolean"==typeof r&&(this._muted=r),"number"==typeof s&&(this._cleanUpInterval=s),"boolean"==typeof u&&(this._autoEnable=u),"function"==typeof l&&this.on(c.Add,l),"function"==typeof d&&this.on(c.Remove,d),"function"==typeof p&&this.on(c.Stop,p),"function"==typeof y&&this.on(c.Pause,y),"function"==typeof v&&this.on(c.Mute,v),"function"==typeof m&&this.on(c.Volume,m),"function"==typeof b&&this.on(c.Suspend,b),"function"==typeof g&&this.on(c.Resume,g),"function"==typeof k&&this.on(c.Error,k),"function"==typeof S&&this.on(c.Done,S),this._loader=new o.default(this._context),this._autoEnable&&"suspended"===this._context.state&&_.forEach(function(e){return document.addEventListener(e,t._resumeAndRemoveListeners)}),this._gainNode=this._context.createGain(),this._gainNode.gain.setValueAtTime(this._muted?0:this._volume,this._context.currentTime),this._gainNode.connect(this._context.destination),this._intervalId=window.setInterval(this._heap.free,60*this._cleanUpInterval*1e3),this._state="suspended"!==this._context.state?f.Ready:f.Suspended,this}},{key:"load",value:function(e){return this._loader.load(e)}},{key:"unload",value:function(e){return this._loader.unload(e),this}},{key:"mute",value:function(){return this._muted?this:(this._gainNode.gain.setValueAtTime(0,this._context.currentTime),this._muted=!0,this._fire(c.Mute,this._muted),this)}},{key:"unmute",value:function(){return this._muted?(this._gainNode.gain.setValueAtTime(this._volume,this._context.currentTime),this._muted=!1,this._fire(c.Mute,this._muted),this):this}},{key:"volume",value:function(e){return void 0===e?this._volume:"number"!=typeof e||e<0||e>1?this:(this._gainNode.gain.setValueAtTime(this._muted?0:e,this._context.currentTime),this._volume=e,this._fire(c.Volume,this._volume),this)}},{key:"stop",value:function(){return this._heap.sounds().forEach(function(e){return e.stop()}),this._fire(c.Stop),this}},{key:"suspend",value:function(){var e=this;return this._state===f.Resuming?(this._queue.add("after-resume","suspend",function(){return e.suspend()}),this):this._state!==f.Ready?this:(this.stop(),this._state=f.Suspending,this._context.suspend().then(function(){e._state=f.Suspended,e._queue.run("after-suspend"),e._fire(c.Suspend)}),this)}},{key:"resume",value:function(){var e=this;return this._state===f.Suspending?(this._queue.add("after-suspend","resume",function(){return e.resume()}),this):this._state!==f.Suspended?this:(this._state=f.Resuming,this._context.resume().then(function(){e._state=f.Ready,e._queue.run("after-resume"),e._fire(c.Resume)}),this)}},{key:"terminate",value:function(){var e=this;if(this._state===f.Done||this._state===f.Destroying)return this;var t=function(){_.forEach(function(t){return document.addEventListener(t,e._resumeAndRemoveListeners)}),e._intervalId&&window.clearInterval(e._intervalId),e._intervalId=null,e._heap.destroy(),e._heap=null,e._loader&&(e._loader.dispose(),e._loader=null),e._context=null,e._queue.clear(),e._queue=null,e._state=f.Done,e._fire(c.Done),r.default.clear(e._id)};if(this._context){if(this._state===f.Suspending)return this._queue.remove("after-suspend"),this._queue.add("after-suspend","destroy",function(){return e.terminate()}),this;if(this._state===f.Resuming)return this._queue.remove("after-resume"),this._queue.add("after-resume","destroy",function(){return e.terminate()}),this;this._state=f.Destroying,this._context&&this._context.close().then(function(){return t()})}else this._state=f.Destroying,t();return this}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r.default.on(this._id,e,t,n),this}},{key:"off",value:function(e,t){return r.default.off(this._id,e,t),this}},{key:"sound",value:function(e,t,n){if("number"==typeof e)return this._heap.sound(e);var i=new l.default(n);return this._heap.add(e,t,i),i._gain().connect(this._gainNode),i}},{key:"sounds",value:function(e){return this._heap.sounds(e)}},{key:"free",value:function(e,t){return this._heap.free(e,t),this}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"context",value:function(){return this._context}},{key:"isAudioAvailable",value:function(){return this._isAudioAvailable}},{key:"_fire",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return r.default.fire.apply(r.default,[this._id,e].concat(n,[this])),this}},{key:"_resumeAndRemoveListeners",value:function(){var e=this;this.resume(),_.forEach(function(t){return document.addEventListener(t,e._resumeAndRemoveListeners)})}}]),e}());t.default=p,t.EngineState=f,t.EngineEvents=c,t.ErrorType=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadStatus=t.DownloadResult=t.default=void 0;var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(0),s=(i=r)&&i.__esModule?i:{default:i};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a={Success:"success",Failure:"error"},l=function e(t,n,i){u(this,e),this.url=null,this.value=null,this.error=null,this.status=null,this.url=t,this.value=n,this.error=i||null,this.status=i?a.Failure:a.Success},d=function(){function e(t){u(this,e),this._context=null,this._bufferCache={},this._progressCallsAndCallbacks={},this._disposed=!1,this._context=t}return o(e,[{key:"load",value:function(e){var t=this;return"string"==typeof e?this._load(e):Promise.all(e.map(function(e){return t._load(e)}))}},{key:"unload",value:function(e){var t=this;"string"!=typeof e?Array.isArray(e)?e.forEach(function(e){return t._unload(e)},this):this._bufferCache={}:this._unload(e)}},{key:"dispose",value:function(){this._disposed||(this.unload(),this._bufferCache={},this._progressCallsAndCallbacks=null,this._context=null,this._disposed=!0)}},{key:"_load",value:function(e){var t=this;return new Promise(function(n){if(t._bufferCache.hasOwnProperty(e))n(new l(e,t._bufferCache[e]));else if(t._progressCallsAndCallbacks.hasOwnProperty(e))t._progressCallsAndCallbacks[e].push(n);else{t._progressCallsAndCallbacks[e]=[],t._progressCallsAndCallbacks[e].push(n);var i=function(n){t._disposed||(t._progressCallsAndCallbacks[e].forEach(function(t){return t(new l(e,null,n))}),delete t._progressCallsAndCallbacks[e])},o=function(n){t._disposed||t._context.decodeAudioData(n,function(n){t._bufferCache[e]=n,t._progressCallsAndCallbacks[e].forEach(function(t){return t(new l(e,n))}),delete t._progressCallsAndCallbacks[e]},i)};if(s.default.isBase64(e)){for(var r=atob(e.split(",")[1]),u=new Uint8Array(r.length),a=0;a<r.length;++a)u[a]=r.charCodeAt(a);o(u)}else{var d=new XMLHttpRequest;d.open("GET",e,!0),d.responseType="arraybuffer",d.addEventListener("load",function(){return o(d.response)},!1),d.addEventListener("error",i,!1),d.send()}}})}},{key:"_unload",value:function(e){delete this._bufferCache[e]}}]),e}();t.default=d,t.DownloadResult=l,t.DownloadStatus=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._objectsEventsHandlersMap={}}return i(e,[{key:"on",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._hasObject(e)||(this._objectsEventsHandlersMap[e]={});var o=this._objectsEventsHandlersMap[e];return o.hasOwnProperty(t)||(o[t]=[]),o[t].push({handler:n,once:i}),this}},{key:"off",value:function(e,t,n){if(!this._hasEvent(e,t))return this;var i=this._objectsEventsHandlersMap[e];return i[t]=n?i[t].filter(function(e){return e.handler!==n}):[],this}},{key:"fire",value:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(!this._hasEvent(e,t))return this;for(var r=this._objectsEventsHandlersMap[e][t],s=0;s<r.length;s++){var u=r[s];setTimeout(function(n){var o=n.handler,r=n.once;o.apply(void 0,i),r&&this.off(e,t,o)}.bind(this,u),0)}return this}},{key:"clear",value:function(e){return e?(this._hasObject(e)&&delete this._objectsEventsHandlersMap[e],this):(this._objectsEventsHandlersMap={},this)}},{key:"_hasObject",value:function(e){return this._objectsEventsHandlersMap.hasOwnProperty(e)}},{key:"_hasEvent",value:function(e,t){return this._hasObject(e)&&this._objectsEventsHandlersMap[e].hasOwnProperty(t)}}]),e}();t.default=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventActions={}}return i(e,[{key:"add",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.hasEvent(e)||(this._eventActions[e]={}),this._eventActions[e][t]={fn:n,removeAfterRun:i}}},{key:"hasEvent",value:function(e){return this._eventActions.hasOwnProperty(e)}},{key:"hasAction",value:function(e,t){return!!this.hasEvent(e)&&this._eventActions[e].hasOwnProperty(t)}},{key:"run",value:function(e,t){var n=this;if(this.hasEvent(e))if(void 0===t)Object.keys(this._eventActions[e]).forEach(function(t){return n._run(e,t)});else{if(!this.hasAction(e,t))return;this._run(e,t)}}},{key:"remove",value:function(e,t){this._eventActions.hasOwnProperty(e)&&(t?delete this._eventActions[e][t]:delete this._eventActions[e])}},{key:"clear",value:function(){this._eventActions={}}},{key:"_run",value:function(e,t){var n=this._eventActions[e][t];n.fn(),n.removeAfterRun&&this.remove(e,t)}}]),e}();t.default=o},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(1),s=h(r),u=h(n(4)),a=h(n(0)),l=h(n(3)),d=n(2);function h(e){return e&&e.__esModule?e:{default:e}}var f={Ready:"ready",Destroyed:"destroyed"},c={Load:"load",UnLoad:"unload",PlayStart:"playstart",PlayEnd:"playend",Pause:"pause",Stop:"stop",Volume:"volume",Mute:"mute",Seek:"seek",Rate:"rate",FadeStart:"fadestart",FadeEnd:"fadeend",FadeStop:"fadestop",Error:"error",Destroy:"destroy"},_={NotLoaded:"notloaded",Loading:"loading",Loaded:"loaded"},p=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=-1,this._src=null,this._format=[],this._sprite=null,this._volume=1,this._rate=1,this._muted=!1,this._loop=!1,this._preload=!1,this._autoplay=!1,this._buffer=null,this._duration=0,this._compatibleSrc=null,this._loadState=_.NotLoaded,this._state=f.Ready,this._queue=null,this._engine=null,this._fading=!1,this._fadeTimer=null,this._engine=s.default,this._engine.setup(),this._engine.on(r.EngineEvents.Resume,this._onEngineResume=this._onEngineResume.bind(this)),!this._engine.isAudioAvailable())return this._fire(c.Error,null,{type:r.ErrorType.NoAudio,error:"Web Audio is un-available"}),this;if("string"==typeof t)this._src=[t];else if(Array.isArray(t)&&t.length)this._src=t;else if("object"===(void 0===t?"undefined":i(t))){var n=t.id,o=t.src,l=t.format,d=t.sprite,h=t.volume,p=t.rate,y=t.muted,v=t.loop,m=t.autoplay,b=t.preload,g=t.onload,k=t.onunload,S=t.onplaystart,E=t.onplayend,P=t.onstop,T=t.onpause,A=t.onmute,w=t.onvolume,x=t.onrate,C=t.onseek,N=t.onerror,O=t.ondestroy;this._id="number"==typeof n?n:a.default.id(),"string"==typeof o?this._src=[o]:Array.isArray(o)&&o.length&&(this._src=o),Array.isArray(l)?this._format=l:"string"==typeof l&&l&&(this._format=[l]),"object"===(void 0===d?"undefined":i(d))&&(this._sprite=d),"number"==typeof h&&h>=0&&h<=1&&(this._volume=h),"number"==typeof p&&p>=.5&&p<=5&&(this._rate=p),"boolean"==typeof y&&(this._muted=y),"boolean"==typeof v&&(this._loop=v),"boolean"==typeof m&&(this._autoplay=m),"boolean"==typeof b&&(this._preload=b),"function"==typeof g&&this.on(c.Load,g),"function"==typeof k&&this.on(c.UnLoad,k),"function"==typeof S&&this.on(c.PlayStart,S),"function"==typeof E&&this.on(c.PlayEnd,E),"function"==typeof P&&this.on(c.Stop,P),"function"==typeof T&&this.on(c.Pause,T),"function"==typeof A&&this.on(c.Mute,A),"function"==typeof w&&this.on(c.Volume,w),"function"==typeof x&&this.on(c.Rate,x),"function"==typeof C&&this.on(c.Seek,C),"function"==typeof N&&this.on(c.Error,N),"function"==typeof O&&this.on(c.Destroy,O)}if(!this._src)throw new Error("You should pass the source for the audio.");this._queue=new u.default,this._autoplay?this.play():this._preload&&this.load()}return o(e,[{key:"load",value:function(){var e=this;if(this.isLoaded()||this._loadState===_.Loading)return this;this._loadState=_.Loading;var t=this._compatibleSrc||(this._compatibleSrc=this.getCompatibleSource());return t?(this._engine.load(t).then(function(t){if(e._loadState!==_.NotLoaded&&e._state!==f.Destroyed)return t.status===d.DownloadStatus.Success?(e._buffer=t.value,e._duration=e._buffer.duration,e._loadState=_.Loaded,e._fire(c.Load,null,t),void e._queue.run("after-load")):void e._onLoadFailure(t.error)}),this):(this._onLoadFailure("The audio formats you passed are not supported"),this)}},{key:"_onLoadFailure",value:function(e){this._queue.remove("after-load"),this._loadState=_.NotLoaded,this._fire(c.Error,null,{type:r.ErrorType.LoadError,error:e})}},{key:"getCompatibleSource",value:function(){return this._format.length?this._src[this._format.indexOf(a.default.getSupportedFormat(this._format))]:a.default.getSupportedSource(this._src)}},{key:"play",value:function(e){var t=this;if("number"==typeof e){var n=this._engine.sound(e);return n&&this._play(n),this}var i=a.default.id(),o=function(){var n={id:i,buffer:t._buffer,volume:t._volume,rate:t._rate,muted:t._muted,loop:t._loop,playEndCallback:function(e){return t._fire(c.PlayEnd,e.id())},destroyCallback:function(e){t._fire(c.Destroy,e.id()),l.default.clear(e.id())},fadeEndCallback:function(e){return t._fire(c.FadeEnd,e.id())}};if("string"==typeof e&&t._sprite&&t._sprite.hasOwnProperty(e)){var o=t._sprite[e];n.startPos=o[0],n.endPos=o[1]}var r=t._engine.sound(t._compatibleSrc,t._id,n);t._play(r)};return this.isLoaded()?o():(this._queue.add("after-load","play-"+i,function(){return o()}),this.load()),i}},{key:"pause",value:function(e){return this._removePlayActions(e),"number"!=typeof e&&this.fadeStop(),this._sounds(e).forEach(function(e){return e.pause()}),this._fire(c.Pause,e),this}},{key:"stop",value:function(e){return this._removePlayActions(e),"number"!=typeof e&&this.fadeStop(),this._sounds(e).forEach(function(e){return e.stop()}),this._fire(c.Stop,e),this}},{key:"mute",value:function(e){var t="number"!=typeof e;return t&&this.fadeStop(),this._sounds(e).forEach(function(e){return e.mute()}),t&&(this._muted=!0),this._fire(c.Mute,e,this._muted),this}},{key:"unmute",value:function(e){var t="number"!=typeof e;return t&&this.fadeStop(),this._sounds(e).forEach(function(e){return e.unmute()}),t&&(this._muted=!1),this._fire(c.Mute,e,this._muted),this}},{key:"volume",value:function(e,t){var n="number"!=typeof t;if("number"==typeof e&&e>=0&&e<=1)return n&&this.fadeStop(),this._sounds(t).forEach(function(t){return t.volume(e)}),"number"!=typeof t&&(this._volume=e),this._fire(c.Volume,t,this._volume),this;if(!n){var i=this._engine.sound(t);return i?i.volume():null}return this._volume}},{key:"fade",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",o=arguments[3],r="number"!=typeof o;return r&&this._fading?this:(this._fire(c.FadeStart,o),this._sounds(o).forEach(function(n){return n.fade(e,t,i)}),r&&(this._fading=!0,this._fadeTimer=setTimeout(function(){n.volume(e),clearTimeout(n._fadeTimer),n._fadeTimer=null,n._fading=!1,n._fire(c.FadeEnd)},1e3*t)),this)}},{key:"fadeStop",value:function(e){var t="number"!=typeof e;return t&&!this._fading?this:(this._sounds(e).forEach(function(e){return e.fadeStop()}),t&&(this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null),this._fading=!1),this._fire(c.FadeStop,e),this)}},{key:"rate",value:function(e,t){if("number"==typeof e&&e>=.5&&e<=5)return this._sounds(t).forEach(function(t){return t.rate(e)}),"number"!=typeof t&&(this._rate=e),this._fire(c.Rate,t,this._rate),this;if("number"==typeof t){var n=this._engine.sound(t);return n?n.rate():null}return this._rate}},{key:"seek",value:function(e,t){var n=this,i=this._engine.sound(e);return i?"number"==typeof t?this.isLoaded()?(i.seek(t),this._fire(c.Seek,e,t),this):(this._queue.add("after-load","seek-"+e,function(){return n.seek(e,t)}),this.load(),this):i.seek():this}},{key:"loop",value:function(e,t){if("boolean"==typeof e)return this._sounds(t).forEach(function(t){return t.loop(e)}),"number"!=typeof t&&(this._loop=e),this;if("number"==typeof t){var n=this._engine.sound(t);return n?n.loop():null}return this._loop}},{key:"playing",value:function(e){var t=this._engine.sound(e);return t?t.isPlaying():null}},{key:"muted",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.muted():null}return this._muted}},{key:"state",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.state():null}return this._state}},{key:"duration",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.duration():null}return this._duration}},{key:"unload",value:function(){return this._queue.remove("after-load"),this._engine.unload(this._compatibleSrc),this._buffer=null,this._duration=0,this._loadState=_.NotLoaded,this}},{key:"destroy",value:function(){this._state!==f.Destroyed&&(this.stop(),this._queue.clear(),this._engine.off(r.EngineEvents.Resume,this._onEngineResume),this._engine.free(!1,this._id),this._buffer=null,this._queue=null,this._engine=null,this._state=f.Destroyed,this._fire(c.Destroy),l.default.clear(this._id))}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments[3];return l.default.on(i||this._id,e,t,n),this}},{key:"off",value:function(e,t,n){return l.default.off(n||this._id,e,t),this}},{key:"id",value:function(){return this._id}},{key:"loadState",value:function(){return this._loadState}},{key:"isLoaded",value:function(){return this._loadState===_.Loaded}},{key:"sound",value:function(e){return this._engine.sound(e)}},{key:"alive",value:function(e){return Boolean(this.sound(e))}},{key:"_onEngineResume",value:function(){this._queue.run("after-engine-resume")}},{key:"_play",value:function(e){var t=this;if(this._engine.state()!==r.EngineState.Destroying&&this._engine.state()!==r.EngineState.Done)if(this._engine.state()!==r.EngineState.NoAudio){var n=function(){e.play(),t._fire(c.PlayStart,e.id())};if([r.EngineState.Suspending,r.EngineState.Suspended,r.EngineState.Resuming].indexOf(this._engine.state())>-1)return this._queue.add("after-engine-resume","sound-"+e.id(),function(){return n()}),void(this._engine.state()!==r.EngineState.Resuming&&this._engine.resume());n()}else this._fire(c.Error,null,{type:r.ErrorType.NoAudio,error:"Web Audio is un-available"});else this._fire(c.Error,null,{type:r.ErrorType.PlayError,error:"The engine is stopping/stopped"})}},{key:"_removePlayActions",value:function(e){this._queue.remove("after-load",e?"play-"+e:null),this._queue.remove("after-engine-resume",e?"sound-"+e:null)}},{key:"_sounds",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?[t]:[]}return this._engine.sounds(this._id)}},{key:"_fire",value:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return t?(l.default.fire.apply(l.default,[t,e].concat(i,[this.sound(t),this])),l.default.fire.apply(l.default,[this._id,e].concat(i,[this.sound(t),this]))):l.default.fire.apply(l.default,[this._id,e].concat(i,[this])),this}}]),e}(),y=function(e){return new p(e)};["setup","load","unload","mute","unmute","volume","stop","suspend","resume","terminate","muted","state","context","isAudioAvailable","on","off"].forEach(function(e){y[e]=function(){var t=s.default[e].apply(s.default,arguments);return t===s.default?y:t}}),e.exports=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function e(t,n){o(this,e),this.sound=null,this.groupId=null,this.groupId=t,this.sound=n},s=function(){function e(){o(this,e),this.url=null,this.items={}}return i(e,[{key:"add",value:function(e,t){var n=t.id().toString();this.items.hasOwnProperty(n)||(this.items[n]=new r(e,t))}},{key:"free",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments[1];Object.values(this.items).forEach(function(i){var o=i.sound,r=i.soundGroupId;t&&(o.isPlaying()||o.isPaused())||Boolean(n)&&r!==n||(o.destroy(),delete e.items[o.id()])})}},{key:"sounds",value:function(e){var t=Object.values(this.items);return(e?t.filter(function(t){return t.groupId===e}):t).map(function(e){return e.sound})}},{key:"destroy",value:function(){Object.values(this.items).forEach(function(e){return e.sound.destroy()}),this.items={}}}]),e}(),u=function(){function e(){o(this,e),this._collections={},this.free=this.free.bind(this)}return i(e,[{key:"add",value:function(e,t,n){this._collections.hasOwnProperty(e)||(this._collections[e]=new s),this._collections[e].add(t,n)}},{key:"sound",value:function(e){return this.sounds().find(function(t){return t.id()===e})}},{key:"sounds",value:function(e){var t=[];return Object.values(this._collections).forEach(function(n){return t.push.apply(t,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n.sounds(e)))}),t}},{key:"free",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];Object.values(this._collections).forEach(function(n){return n.free(e,t)})}},{key:"destroy",value:function(){Object.values(this._collections).forEach(function(e){return e.destroy()}),this._collections={}}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SoundState=t.default=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=s(n(1)),r=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u={Ready:"ready",Playing:"playing",Paused:"paused",Destroyed:"destroyed"},a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=-1,this._volume=1,this._rate=1,this._muted=!1,this._loop=!1,this._state=u.Ready,this._context=null,this._gainNode=null,this._buffer=null,this._bufferSourceNode=null,this._duration=0,this._startPos=0,this._endPos=0,this._currentPos=0,this._rateSeek=0,this._startTime=0,this._playEndCallback=null,this._destroyCallback=null,this._fading=!1,this._fadeTimer=null,this._fadeEndCallback=null;var n=t.id,i=t.buffer,s=t.volume,a=t.rate,l=t.loop,d=t.muted,h=t.startPos,f=t.endPos,c=t.playEndCallback,_=t.destroyCallback,p=t.fadeEndCallback;this._id="number"==typeof n?n:r.default.id(),this._buffer=i,this._endPos=this._buffer.duration,s&&(this._volume=s),a&&(this._rate=a),d&&(this._muted=d),l&&(this._loop=l),h&&(this._startPos=h),f&&(this._endPos=f),this._playEndCallback=c,this._destroyCallback=_,this._fadeEndCallback=p,this._duration=this._endPos-this._startPos,this._context=o.default.context(),this._gainNode=this._context.createGain(),this._gainNode.gain.setValueAtTime(this._muted?0:this._volume,this._context.currentTime)}return i(e,[{key:"play",value:function(){var e=this;if(this.isPlaying())return this;var t=Math.max(0,this._currentPos>0?this._currentPos:this._startPos);this._bufferSourceNode=this._context.createBufferSource(),this._bufferSourceNode.buffer=this._buffer,this._bufferSourceNode.playbackRate.setValueAtTime(this._rate,this._context.currentTime),this._setLoop(this._loop),this._bufferSourceNode.connect(this._gainNode),this._bufferSourceNode.addEventListener("ended",function(){e._currentPos=0,e._rateSeek=0,e._destroyBufferNode(),e._state=u.Ready,e._playEndCallback&&e._playEndCallback(e)});var n=this._context.currentTime;return void 0!==this._bufferSourceNode.start?this._bufferSourceNode.start(n,t,this._loop?void 0:this._duration):this._bufferSourceNode.noteGrainOn(n,t,this._loop?void 0:this._duration),this._startTime=n,this._state=u.Playing,this}},{key:"pause",value:function(){return this.isPlaying()?(this.fadeStop(),this._currentPos=this.seek(),this._rateSeek=0,this._destroyBufferNode(),this._state=u.Paused,this):this}},{key:"stop",value:function(){return this.isPlaying()||this.isPaused()?(this.fadeStop(),this._currentPos=0,this._rateSeek=0,this._destroyBufferNode(),this._state=u.Ready,this):this}},{key:"mute",value:function(){return this.fadeStop(),this._gainNode.gain.setValueAtTime(0,this._context.currentTime),this._muted=!0,this}},{key:"unmute",value:function(){return this.fadeStop(),this._gainNode.gain.setValueAtTime(this._volume,this._context.currentTime),this._muted=!1,this}},{key:"volume",value:function(e){return void 0===e?this._volume:(this.fadeStop(),this._gainNode.gain.setValueAtTime(this._muted?0:e,this._context.currentTime),this._volume=e,this)}},{key:"fade",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear";return this._fading&&this.fadeStop(),this._fading=!0,"linear"===i?this._gainNode.gain.linearRampToValueAtTime(e,this._context.currentTime+t):this._gainNode.gain.exponentialRampToValueAtTime(e,this._context.currentTime+t),this._fadeTimer=setTimeout(function(){n.volume(e),clearTimeout(n._fadeTimer),n._fadeTimer=null,n._fading=!1,n._fadeEndCallback&&n._fadeEndCallback(n)},1e3*t),this}},{key:"fadeStop",value:function(){return this._fading?(this._gainNode.gain.cancelScheduledValues(this._context.currentTime),this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null),this._fading=!1,this.volume(this._gainNode.gain.value),this):this}},{key:"rate",value:function(e){return void 0===e?this._rate:(this._rate=e,this._rateSeek=this.seek(),this.isPlaying()&&(this._startTime=this._context.currentTime,this._bufferSourceNode&&this._bufferSourceNode.playbackRate.setValueAtTime(e,this._context.currentTime)),this)}},{key:"seek",value:function(e){if(void 0===e){var t=this.isPlaying()?this._context.currentTime-this._startTime:0,n=this._rateSeek?this._rateSeek-this._currentPos:0;return this._currentPos+(n+t*this._rate)}if(e<this._startPos||e>this._endPos)return this;var i=this.isPlaying();return i&&this.pause(),this._currentPos=e,i&&this.play(),this}},{key:"loop",value:function(e){return"boolean"!=typeof e?this._loop:(this._loop=e,this._setLoop(e),this)}},{key:"destroy",value:function(){return this._state===u.Destroyed?this:(this.stop(),this._gainNode.disconnect(),this._buffer=null,this._context=null,this._gainNode=null,this._state=u.Destroyed,this._destroyCallback&&this._destroyCallback(this),this)}},{key:"id",value:function(){return this._id}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"duration",value:function(){return this._duration}},{key:"isPlaying",value:function(){return this._state===u.Playing}},{key:"isPaused",value:function(){return this._state===u.Paused}},{key:"_gain",value:function(){return this._gainNode}},{key:"_destroyBufferNode",value:function(){this._bufferSourceNode&&(void 0!==this._bufferSourceNode.stop?this._bufferSourceNode.stop():this._bufferSourceNode.noteGrainOff(),this._bufferSourceNode.disconnect(),this._bufferSourceNode.removeEventListener("ended",this._onEnded),this._bufferSourceNode=null)}},{key:"_setLoop",value:function(e){this._bufferSourceNode&&(this._bufferSourceNode.loop=e,e&&(this._bufferSourceNode.loopStart=this._startPos,this._bufferSourceNode.loopEnd=this._endPos))}}]),e}();t.default=a,t.SoundState=u}])});
//# sourceMappingURL=musquito-1.1.2.min.js.map